{"version":3,"file":"common.es.js","sources":["../src/types.ts","../src/actions.ts","../src/sources.js","../src/api/firestore.ts","../src/api/user.js","../src/browser/storage.ts","../src/browser/url.ts","../src/browser/index.js","../src/api/comments.js","../src/api/workspace.ts","../src/api/authentication.ts","../src/api/activity.ts","../src/api/invites.js","../src/api/index.js","../src/token.ts"],"sourcesContent":["import { AnyAction } from 'redux';\n\nconst namespacedAction = (name: string): string => `@diff/common/${name}`;\n\nexport interface AsyncType {\n  REQUEST: string;\n  SUCCESS: string;\n  FAILED: string;\n}\n\nconst asyncAction = (actionType: string): AsyncType => ({\n  REQUEST: namespacedAction(`${actionType}/request`),\n  SUCCESS: namespacedAction(`${actionType}/success`),\n  FAILED: namespacedAction(`${actionType}/failed`)\n});\n\nexport default {\n  FETCH_USER_PREFERENCES: asyncAction('fetchUserPreferences'),\n  RUN_REQUEST: asyncAction('runRequest'),\n  LOGIN: asyncAction('login'),\n  CACHE_TOKEN: asyncAction('cacheToken'),\n  FETCH_CACHE_TOKEN: asyncAction('fetchCacheToken'),\n  FEATURE_FLAGS_UPDATE: 'featureFlagUpdate'\n};\n","import { AnyAction } from 'redux';\nimport types from './types';\n\nexport interface RemoteAction {\n  source: string;\n  dest: string;\n  action: AnyAction;\n}\n\nexport interface Token {\n  access_token: string;\n  refresh_token: string;\n}\n\nconst composeRemoteAction = (\n  action: AnyAction,\n  source: string,\n  dest: string\n): AnyAction => ({\n  source,\n  dest,\n  ...action\n});\n\n// -------------------------------------------------------\n// User actions\n// -------------------------------------------------------\n\nconst runRequest = () => ({\n  type: types.RUN_REQUEST.REQUEST\n});\n\n// -------------------------------------------------------\n// User actions\n// -------------------------------------------------------\n\ninterface FetchUserRequestAction extends AnyAction {\n  payload: {\n    hostname: string;\n    pathname: string;\n  };\n}\n\nconst fetchUserPreferences = (\n  hostname: string,\n  pathname: string\n): FetchUserRequestAction => ({\n  type: types.FETCH_USER_PREFERENCES.REQUEST,\n  payload: {\n    hostname,\n    pathname\n  }\n});\n\nconst fetchUserPreferencesSuccess = (preferences: Object): AnyAction => ({\n  type: types.FETCH_USER_PREFERENCES.SUCCESS,\n  payload: {\n    ...preferences\n  }\n});\n\nconst fetchUserPreferencesFailed = (error: string): AnyAction => ({\n  type: types.FETCH_USER_PREFERENCES.FAILED,\n  payload: {\n    error\n  }\n});\n\n// -------------------------------------------------------\n// Set cache token actions\n// -------------------------------------------------------\n\nconst cacheTokenRequest = (token: string): AnyAction => ({\n  type: types.CACHE_TOKEN.REQUEST,\n  payload: {\n    token\n  }\n});\n\nconst cacheTokenFailed = (error: string): AnyAction => ({\n  type: types.CACHE_TOKEN.FAILED,\n  payload: {\n    error\n  }\n});\n\nconst cacheTokenSuccess = (): AnyAction => ({\n  type: types.CACHE_TOKEN.SUCCESS\n});\n\n// -------------------------------------------------------\n// get cache token actions\n// -------------------------------------------------------\n\nconst fetchCacheToken = (): AnyAction => ({\n  type: types.FETCH_CACHE_TOKEN.REQUEST\n});\n\nconst fetchCacheTokenFailed = (error: string): AnyAction => ({\n  type: types.FETCH_CACHE_TOKEN.FAILED,\n  payload: {\n    error\n  }\n});\n\nconst fetchCacheTokenSuccess = (token: {}): AnyAction => ({\n  type: types.FETCH_CACHE_TOKEN.SUCCESS,\n  payload: {\n    token\n  }\n});\n\nexport default {\n  composeRemoteAction,\n  runRequest,\n  fetchUserPreferences,\n  fetchUserPreferencesSuccess,\n  fetchUserPreferencesFailed,\n\n  cacheTokenRequest,\n  cacheTokenFailed,\n  cacheTokenSuccess,\n  fetchCacheToken,\n  fetchCacheTokenFailed,\n  fetchCacheTokenSuccess\n};\n","const CONTENT_SCRIPT_PORT_NAME = \"@diff/portname/contentScript\";\nconst CONTENT_SCRIPT_SOURCE_NAME = \"@diff/content\";\nconst BACKGROUND_SCRIPT_PORT_NAME = \"@diff/background\";\nconst MESSAGES_FRONTEND_SOURCE = \"@diff/frontend\";\nconst MESSAGES_BACKGROUND_SOURCE = \"@diff/background\";\n\nexport default {\n  CONTENT_SCRIPT_PORT_NAME,\n  CONTENT_SCRIPT_SOURCE_NAME,\n  BACKGROUND_SCRIPT_PORT_NAME,\n  MESSAGES_FRONTEND_SOURCE,\n  MESSAGES_BACKGROUND_SOURCE\n};\n","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\n\n/**\n * Handles initializion that is required for our firebase application\n */\nexport const initializeFirestore = (): firebase.firestore.Firestore => {\n  console.log(\"[plugin - firebase] initializing connection\");\n\n  // connect to firebase\n  const config = {\n    apiKey: process.env.FIREBASE_API_KEY,\n    authDomain: process.env.FIREBASE_AUTH_DOMAIN,\n    databaseURL: process.env.FIREBASE_DATABASE_URL,\n    projectId: process.env.FIREBASE_PROJECT_ID,\n    storageBucket: process.env.FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.FIREBASE_SENDER_ID\n  };\n  console.log(firebase);\n  firebase.initializeApp(config);\n\n  const firestore = firebase.firestore();\n  const settings = { timestampsInSnapshots: true };\n  firestore.settings(settings);\n\n  return firestore;\n};\n","import \"firebase/auth\";\n\nimport { Observable } from \"rxjs\";\n\nexport default db => {\n  const userRef = db.collection(\"users\");\n\n  const user$ = uid => {\n    return Observable.create(observer => {\n      if (uid == null || uid === undefined) {\n        observer.error(\"uid cannot be null\");\n        observer.complete();\n        return;\n      }\n\n      const unsubscribe = userRef.doc(uid).onSnapshot(doc => {\n        const data = doc.data();\n        observer.next(data);\n      });\n\n      return unsubscribe;\n    });\n  };\n\n  const getUser = uid => {\n    return Observable.create(observer => {\n      db.collection(\"users\")\n        .doc(uid)\n        .get()\n        .then(doc => {\n          if (!doc.exists) {\n            observer.error(\"no user\");\n          } else {\n            observer.next(doc.data());\n          }\n        })\n        .catch(err => {\n          observer.error(err.message);\n        })\n        .finally(() => {\n          observer.complete();\n        });\n    });\n  };\n\n  return {\n    user$,\n    getUser\n  };\n};\n","const setFlag = async (flag: string, value: string): Promise<any> => {\n  return new Promise(resolve => {\n    chrome.storage.local.set({ [flag]: value }, () => {\n      resolve();\n    });\n  });\n};\n\nconst getFlag = async (flag: string): Promise<any> => {\n  return new Promise(resolve => {\n    chrome.storage.local.get([flag], result => {\n      resolve(result[flag]);\n    });\n  });\n};\n\nexport default {\n  getFlag,\n  setFlag\n};\n","const normalizeUrl = require('normalize-url');\n\nconst location = (): URL => {\n  const url = normalizeUrl(window.location.href);\n  return new URL(url);\n};\n\nexport default {\n  location\n};\n","import storage from './storage';\nimport url from './url';\n\nexport default {\n  storage,\n  url\n};\n","import { Observable } from 'rxjs';\r\nimport _ from 'lodash-es';\r\nimport 'firebase/storage';\r\nimport browser from '../browser';\r\n\r\nexport default db => {\r\n  const eventsRef = db.collection('events');\r\n  const commentsRef = eventsRef.where('type', '==', 'comment');\r\n\r\n  const comments$ = (uid, workspaceId) => {\r\n    return Observable.create(observer => {\r\n      const subject = !_.isNil(workspaceId)\r\n        ? 'meta.workspaceId'\r\n        : 'meta.userId';\r\n      const value = !_.isNil(workspaceId) ? workspaceId : uid;\r\n      const location = browser.url.location();\r\n\r\n      const unsubscribe = commentsRef\r\n        .where('url.hostname', '==', location.hostname)\r\n        .where('url.pathname', '==', location.pathname)\r\n        .where(subject, '==', value)\r\n        .onSnapshot(\r\n          querySnapshot => {\r\n            if (!querySnapshot.empty) {\r\n              querySnapshot.docChanges().forEach(({ doc, type }) => {\r\n                const data = doc.data();\r\n                observer.next({ data, type, id: doc.id });\r\n              });\r\n            }\r\n          },\r\n          err => observer.err(err)\r\n        );\r\n\r\n      return () => {\r\n        console.log('Unsubuscribing from comments');\r\n        unsubscribe();\r\n      };\r\n    });\r\n  };\r\n\r\n  const uploadFile = async (file, uid) => {\r\n    const storageRef = db.app.storage().ref(`attachments/${uid}/${file.name}`);\r\n    const task = storageRef.put(file);\r\n\r\n    return new Promise((resolve, reject) => {\r\n      task.on(\r\n        'state_changed',\r\n        function progress(snapshot) {\r\n          // var percentage =\r\n          //   (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n          // console.log(percentage);\r\n        },\r\n        function error(error) {\r\n          reject(error);\r\n        },\r\n        function complete() {\r\n          task.snapshot.ref.getDownloadURL().then(downloadURL => {\r\n            resolve({ url: downloadURL, name: file.name });\r\n          });\r\n        }\r\n      );\r\n    });\r\n  };\r\n\r\n  const addNewComment = async (\r\n    comment,\r\n    selector,\r\n    uploadAttachment,\r\n    uid,\r\n    workspaceId\r\n  ) => {\r\n    if (_.isNil(uid)) {\r\n      throw new Error('UID cannot be undefined');\r\n    }\r\n\r\n    if (_.isNil(comment)) {\r\n      throw new Error('comment cannot be undefined');\r\n    }\r\n\r\n    if (_.isNil(selector)) {\r\n      throw new Error('selector cannot be undefined');\r\n    }\r\n\r\n    const attachments = await Promise.all(\r\n      uploadAttachment.map(file => uploadFile(file, uid))\r\n    );\r\n\r\n    const location = browser.url.location();\r\n\r\n    const record = {\r\n      comment,\r\n      selector,\r\n      type: 'comment',\r\n      meta: {\r\n        userId: uid,\r\n        created: Date.now()\r\n      },\r\n      attachments,\r\n      url: {\r\n        hash: location.hash,\r\n        hostname: location.hostname,\r\n        href: location.href,\r\n        origin: location.origin,\r\n        pathname: location.pathname,\r\n        port: location.port,\r\n        protocol: location.protocol,\r\n        search: location.search\r\n      }\r\n    };\r\n\r\n    if (workspaceId) {\r\n      record.meta.workspaceId = workspaceId;\r\n    }\r\n\r\n    const newEvent = eventsRef.doc();\r\n    await newEvent.set(record);\r\n    return newEvent.id;\r\n  };\r\n\r\n  return {\r\n    comments$,\r\n    uploadFile,\r\n    addNewComment\r\n  };\r\n};\r\n","import { Observable, Observer } from \"rxjs\";\nimport firebase from \"firebase\";\nimport _ from \"lodash-es\";\n\nexport interface QueryResponse {\n  data: Object | firebase.firestore.DocumentData | undefined;\n  type?: string | undefined;\n  id: string;\n}\n\nexport interface CreateWorkspaceResponse {\n  workspaceId: string;\n}\n\nexport default (db: firebase.firestore.Firestore): Object => {\n  const workspaceRef = db.collection(\"workspace\");\n\n  const workspaces$ = (uid: string): Observable<QueryResponse> => {\n    return Observable.create((observer: Observer<QueryResponse>) => {\n      if (_.isNil(uid)) {\n        observer.error(\"uid cannot be null\");\n        observer.complete();\n        return;\n      }\n\n      const unsubscribe = workspaceRef\n        .where(`users.${uid}.role`, \">\", \"\")\n        .onSnapshot(\n          querySnapshot => {\n            querySnapshot.docChanges().forEach(({ doc, type }) => {\n              const data = doc.data();\n              observer.next({ data, type, id: doc.id });\n            });\n          },\n          err => {\n            observer.error(err);\n          }\n        );\n\n      return unsubscribe;\n    });\n  };\n\n  const workspaceForId$ = (workspaceId: string): Observable<QueryResponse> => {\n    return Observable.create((observer: Observer<QueryResponse>) => {\n      if (_.isNil(workspaceId)) {\n        observer.error(\"workspaceId cannot be null\");\n        observer.complete();\n        return;\n      }\n\n      const unsubscribe = workspaceRef.doc(workspaceId).onSnapshot(\n        doc => {\n          if (doc.exists) {\n            const queryResponse: QueryResponse = {\n              data: doc.data(),\n              id: doc.id\n            };\n\n            observer.next(queryResponse);\n          } else {\n            observer.error(\"document does not exist\");\n          }\n        },\n        err => {\n          observer.error(err);\n        }\n      );\n\n      return unsubscribe;\n    });\n  };\n\n  const getIdToken = async () => {\n    const user = db.app.auth().currentUser;\n    const idToken = user && (await user.getIdToken(true));\n\n    if (_.isNil(idToken)) {\n      throw new Error(\"User Token not retrievable. Is user logged in?\");\n    }\n\n    return idToken;\n  };\n\n  const addCollaborators = async (\n    emails: Array<string>,\n    workspaceId: string\n  ): Promise<Object> => {\n    if (_.isEmpty(emails) || _.isNil(emails)) {\n      throw new Error(\"emails is required\");\n    }\n\n    if (_.isNil(workspaceId)) {\n      throw new Error(\"workspace id is required\");\n    }\n\n    const idToken = await getIdToken();\n\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${idToken}`\n      },\n      body: JSON.stringify({\n        emails,\n        workspaceId\n      })\n    };\n\n    const response = await fetch(`${process.env.API_SERVER}/invite`, {\n      ...options,\n      method: \"POST\"\n    });\n\n    if (!response.ok) {\n      return Promise.reject(response.statusText);\n    }\n\n    return response.json();\n  };\n\n  const addSingleCollaborator = async (\n    email: string,\n    workspaceId: string\n  ): Promise<Object> => addCollaborators([email], workspaceId);\n\n  const createWorkspace = async (\n    name: string\n  ): Promise<CreateWorkspaceResponse> => {\n    if (_.isNil(name)) {\n      throw new Error(\"Workspace name is required\");\n    }\n\n    const idToken = await getIdToken();\n\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${idToken}`\n      },\n      body: JSON.stringify({\n        name\n      })\n    };\n\n    const response = await fetch(`${process.env.API_SERVER}/workspace`, {\n      ...options,\n      method: \"POST\"\n    });\n\n    if (!response.ok) {\n      return Promise.reject(response.statusText);\n    }\n\n    return response.json();\n  };\n\n  return {\n    workspaces$,\n    workspaceForId$,\n    addCollaborators,\n    addSingleCollaborator,\n    createWorkspace\n  };\n};\n","import \"firebase/auth\";\n\nexport interface AuthenticationResponse {\n  refresh_token: string;\n  access_token: string;\n}\n\nexport default (db: any) => {\n  const authenticate = async (\n    username: string,\n    password: string,\n    refreshToken?: string\n  ): Promise<AuthenticationResponse> => {\n    const options = refreshToken\n      ? {\n          body: `refresh_token=${refreshToken}&grant_type=refresh_token`\n        }\n      : {\n          headers: {\n            Authorization: `Basic ${btoa(`${username}:${password}`)}`\n          }\n        };\n\n    const response = await fetch(`${process.env.API_SERVER}/authenticate`, {\n      ...options,\n      method: \"POST\"\n    });\n\n    if (!response.ok) {\n      return Promise.reject(\"The username or password is incorrect\");\n    }\n\n    return response.json();\n  };\n\n  const signup = async (\n    email: string,\n    password: string,\n    displayName: string\n  ): Promise<any> => {\n    const options = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email,\n        password,\n        displayName\n      })\n    };\n\n    const response = await fetch(`${process.env.API_SERVER}/signup`, {\n      ...options,\n      method: \"POST\"\n    });\n\n    if (!response.ok) {\n      return Promise.reject(response.statusText);\n    }\n\n    return response.json();\n  };\n\n  const isUser = async (email: string): Promise<string> => {\n    const response = await fetch(\n      `${process.env.API_SERVER}/validate?email=${email}`\n    );\n\n    if (!response.ok) {\n      return Promise.reject(response.statusText);\n    }\n\n    return response.text();\n  };\n\n  const login = async (\n    username: string,\n    password: string,\n    refreshToken: string\n  ): Promise<any> => {\n    const token = await authenticate(username, password, refreshToken);\n    // login to firebase\n\n    const results = await db.app\n      .auth()\n      .signInWithCustomToken(token.access_token);\n\n    return token;\n  };\n\n  return {\n    login,\n    authenticate,\n    signup,\n    isUser\n  };\n};\n","import firebase from \"firebase\";\nimport { Observable, Observer, from } from \"rxjs\";\n\nexport interface QueryResponse {\n  data: Object;\n  type: string;\n  id: string;\n}\n\nexport default (db: firebase.firestore.Firestore): Object => {\n  const activityRef = db.collection(\"activity\");\n\n  const userActivity$ = (uid: string) => {\n    return Observable.create((observer: Observer<QueryResponse>) => {\n      const unsubscribe = activityRef\n        .doc(uid)\n        .collection(\"seen\")\n        .onSnapshot(\n          querySnapshot => {\n            querySnapshot.docChanges().forEach(({ doc, type }) => {\n              observer.next({ data: doc.data(), type, id: doc.id });\n            });\n          },\n          err => observer.error(err)\n        );\n      return unsubscribe;\n    });\n  };\n\n  const createUserActivity$ = (uid: string, eventIds: Array<string>) => {\n    const batch = db.batch();\n\n    // create a batch record for everything\n    eventIds.forEach(docId => {\n      const record = {\n        [docId]: {\n          id: docId,\n          created: Date.now()\n        }\n      };\n\n      const seenActivityRef = activityRef\n        .doc(uid)\n        .collection(\"seen\")\n        .doc(docId);\n\n      batch.set(seenActivityRef, record);\n    });\n\n    // batch everything\n    return from(batch.commit());\n  };\n\n  return {\n    userActivity$,\n    createUserActivity$\n  };\n};\n","import { Observable } from \"rxjs\";\n\nexport default db => {\n  const invitesRef = db.collection(\"invites\");\n\n  const invitesForWorkspace$ = workspaceId => {\n    return Observable.create(observer => {\n      const unsubscribe = invitesRef\n        .where(\"workspaceId\", \"==\", workspaceId)\n        .where(\"status\", \"==\", \"pending\")\n        .onSnapshot(\n          querySnapshot => {\n            querySnapshot.docChanges().forEach(({ doc, type }) => {\n              const data = doc.data();\n              observer.next({ data, type, id: doc.id });\n            });\n          },\n          err => observer.err(err)\n        );\n\n      return unsubscribe;\n    });\n  };\n\n  const inviteForEmail$ = email => {\n    return Observable.create(observer => {\n      const unsubscribe = invitesRef.where(`email`, \"==\", email).onSnapshot(\n        querySnapshot => {\n          querySnapshot.docChanges().forEach(({ doc, type }) => {\n            const data = doc.data();\n            observer.next({ data, type });\n          });\n        },\n        err => {\n          observer.err(err);\n        }\n      );\n\n      return unsubscribe;\n    });\n  };\n\n  return {\n    invitesForWorkspace$,\n    inviteForEmail$\n  };\n};\n","import { initializeFirestore } from './firestore';\nimport userFactory from './user';\nimport commentsFactory from './comments';\nimport workspaceFactory from './workspace';\nimport authenticationFactory from './authentication';\nimport activityFactory from './activity';\nimport inviteFactory from './invites';\n\nexport default () => {\n  const db$ = initializeFirestore();\n  const obs = {\n    user: userFactory(db$),\n    comments: commentsFactory(db$),\n    workspace: workspaceFactory(db$),\n    auth: authenticationFactory(db$),\n    activity: activityFactory(db$),\n    invites: inviteFactory(db$)\n  };\n\n  return obs;\n};\n","export interface DomainResponse {\n  domains: Array<string>;\n}\n\nexport const getDomains = async (token: any): Promise<DomainResponse> => {\n  const response = await fetch(\n    `${process.env.API_SERVER}/tokens/${token}/domains`,\n    {\n      method: 'get'\n    }\n  );\n\n  if (!response.ok) {\n    return Promise.reject(response.statusText);\n  }\n\n  return response.json();\n};\n"],"names":["namespacedAction","name","asyncAction","actionType","REQUEST","SUCCESS","FAILED","FETCH_USER_PREFERENCES","RUN_REQUEST","LOGIN","CACHE_TOKEN","FETCH_CACHE_TOKEN","FEATURE_FLAGS_UPDATE","composeRemoteAction","action","source","dest","runRequest","type","types","fetchUserPreferences","hostname","pathname","payload","fetchUserPreferencesSuccess","preferences","fetchUserPreferencesFailed","error","cacheTokenRequest","token","cacheTokenFailed","cacheTokenSuccess","fetchCacheToken","fetchCacheTokenFailed","fetchCacheTokenSuccess","CONTENT_SCRIPT_PORT_NAME","CONTENT_SCRIPT_SOURCE_NAME","BACKGROUND_SCRIPT_PORT_NAME","MESSAGES_FRONTEND_SOURCE","MESSAGES_BACKGROUND_SOURCE","initializeFirestore","console","log","config","apiKey","process","env","FIREBASE_API_KEY","authDomain","FIREBASE_AUTH_DOMAIN","databaseURL","FIREBASE_DATABASE_URL","projectId","FIREBASE_PROJECT_ID","storageBucket","FIREBASE_STORAGE_BUCKET","messagingSenderId","FIREBASE_SENDER_ID","firebase","initializeApp","firestore","settings","timestampsInSnapshots","db","userRef","collection","user$","uid","Observable","create","observer","undefined","complete","unsubscribe","doc","onSnapshot","data","next","getUser","get","then","exists","catch","err","message","finally","setFlag","flag","value","Promise","resolve","chrome","storage","local","set","getFlag","result","normalizeUrl","require","location","url","window","href","URL","eventsRef","commentsRef","where","comments$","workspaceId","subject","_","isNil","browser","querySnapshot","empty","docChanges","forEach","id","uploadFile","file","storageRef","app","ref","task","put","reject","on","progress","snapshot","getDownloadURL","downloadURL","addNewComment","comment","selector","uploadAttachment","Error","attachments","all","map","record","meta","userId","created","Date","now","hash","origin","port","protocol","search","newEvent","workspaceRef","workspaces$","workspaceForId$","queryResponse","getIdToken","user","auth","currentUser","idToken","addCollaborators","emails","isEmpty","options","method","headers","Authorization","body","JSON","stringify","response","fetch","API_SERVER","ok","statusText","json","addSingleCollaborator","email","createWorkspace","authenticate","username","password","refreshToken","btoa","signup","displayName","isUser","text","login","results","signInWithCustomToken","access_token","activityRef","userActivity$","createUserActivity$","eventIds","batch","docId","seenActivityRef","from","commit","invitesRef","invitesForWorkspace$","inviteForEmail$","db$","obs","userFactory","comments","commentsFactory","workspace","workspaceFactory","authenticationFactory","activity","activityFactory","invites","inviteFactory","getDomains"],"mappings":"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"}